import{r as n,j as e,p as U,q as $,s as D,t as B,B as h,l as H}from"./index-BEj3f1Zo.js";import{u as _,c as M,a as g}from"./index.esm-DLbUUKYT.js";import{C as V}from"./Container-fFTuvLXx.js";import{u as I,c as K}from"./ThemeProvider-CE5WBrlR.js";import{R as O}from"./Row-DlZn-Ylf.js";import{C as Q}from"./Col-DoIGz3MM.js";import{C as v}from"./Card-DUave72A.js";import{B as c}from"./Button-D6hYOcbx.js";import{F as G}from"./FormControl-C1_VRf2P.js";import"./CardHeaderContext-CW5XeT86.js";import"./Button-Cg8Ktlke.js";import"./index-Dmssc253.js";const F=n.forwardRef(({bsPrefix:p,variant:u,animation:o="border",size:l,as:y="div",className:f,...j},b)=>{p=I(p,"spinner");const x=`${p}-${o}`;return e.jsx(y,{ref:b,...j,className:K(f,x,l&&`${x}-${l}`,u&&`text-${u}`)})});F.displayName="Spinner";const ce=()=>{const[p,u]=n.useState(!1),[o,l]=n.useState([]),[y,f]=n.useState([]),{data:j}=U(),[b,{isSuccess:x,isError:E,error:W,isLoading:w}]=$(),[q,{isSuccess:S,isError:C,error:z,isLoading:R}]=D(),[L,{isSuccess:P,isError:k,error:J,isLoading:A}]=B(),[t,N]=n.useState(""),s=_({enableReinitialize:!0,initialValues:{name:t?t.name:"",price:t?t.price:"",desc:t?t.desc:"",hero:t?t.hero:"",qty:t?t.qty:""},validationSchema:M({name:g().required("Enter name"),price:g().required("Enter price"),desc:g().required("Enter desc"),qty:g().required("Enter qty")}),onSubmit:(r,{resetForm:a})=>{if(t){console.log("update called");const i=new FormData;for(const d in r)d!=="hero"&&i.append(d,r[d]);for(const d of o)i.append("remove",d);for(const d of r.hero)i.append("hero",d);L({_id:t._id,fd:i}),N(null),l([])}else{const i=new FormData;for(const d in r)d!=="hero"&&i.append(d,r[d]);for(const d of r.hero)i.append("hero",d);q(i)}f([]),a()}}),m=r=>H({"form-control my-2":!0,"is-invalid":s.touched[r]&&s.errors[r],"is-valid":s.touched[r]&&!s.errors[r]});return n.useEffect(()=>{S&&h.info("Product Added Succesfully")},[S]),n.useEffect(()=>{C&&h.error(error.data.message)},[C]),n.useEffect(()=>{P&&h.info("Product Updated Succesfully")},[P]),n.useEffect(()=>{k&&h.error(error.data.message)},[k]),n.useEffect(()=>{x&&h.info("Product Deleted Succesfully")},[x]),n.useEffect(()=>{E&&h.error(error.data.message)},[E]),e.jsx(e.Fragment,{children:e.jsxs(V,{children:[R||A||w?e.jsxs(e.Fragment,{children:["Please Wait...",e.jsx(F,{})]}):e.jsx(O,{children:e.jsx(Q,{sm:{span:6,offset:3},children:e.jsxs(v,{children:[e.jsx(v.Header,{children:"Products"}),e.jsx(v.Body,{children:e.jsxs("form",{onSubmit:s.handleSubmit,children:[e.jsxs("div",{children:[e.jsx("input",{className:m("name"),...s.getFieldProps("name"),type:"text",placeholder:"Name"}),e.jsx("span",{className:"invalid-feedback",children:s.errors.name})]}),e.jsxs("div",{children:[e.jsx("input",{className:m("price"),...s.getFieldProps("price"),type:"number",placeholder:"price"}),e.jsx("span",{className:"invalid-feedback",children:s.errors.price})]}),e.jsxs("div",{children:[e.jsx("input",{className:m("desc"),...s.getFieldProps("desc"),placeholder:"Description"}),e.jsx("span",{className:"invalid-feedback",children:s.errors.desc})]}),t?e.jsxs(e.Fragment,{children:[t.hero.map(r=>e.jsx("div",{children:e.jsxs("div",{className:`${o.includes(r)&&"border border-danger my-2"} d-flex justify-content-between align-items-center px-4 my-2`,children:[e.jsx("img",{src:r,height:50,className:"me-2 rounded-3"}),o.includes(r)?e.jsx(c,{onClick:a=>{l(o.filter(i=>r!==i))},variant:"dark",children:"Cancel"}):e.jsx(c,{variant:"danger",onClick:a=>{o.includes(r)||l([...o,r])},children:" Remove"})]},r)})),p?e.jsxs(e.Fragment,{children:[e.jsx(G,{type:"file",multiple:!0,onChange:r=>{const a=[];for(const i of r.target.files)a.push(URL.createObjectURL(i));s.setFieldValue("hero",r.target.files),f(a)},className:m("hero"),placeholder:"Enter Product Hero"}),e.jsx(c,{onClick:r=>u(!1),variant:"dark",children:"Cancel"})]}):e.jsx(c,{onClick:r=>u(!0),className:"my-3 w-100",children:"Add New Image"})]}):e.jsxs("div",{children:[e.jsx("input",{className:m("hero"),type:"file",multiple:!0,onChange:r=>{const a=[];for(const i of r.target.files)a.push(URL.createObjectURL(i));f(a),s.setFieldValue("hero",r.target.files)},placeholder:"Image"}),e.jsx("span",{className:"invalid-feedback",children:s.errors.hero})]}),y.map(r=>e.jsx("img",{src:r,height:50})),e.jsxs("div",{children:[e.jsx("input",{className:m("qty"),...s.getFieldProps("qty"),type:"text",placeholder:"Qty."}),e.jsx("span",{className:"invalid-feedback",children:s.errors.qty})]}),t?e.jsxs(e.Fragment,{children:[" ",e.jsx(c,{variant:"warning",className:"w-100",type:"submit",children:" Update Product"}),e.jsx(c,{onClick:r=>N(null),variant:"dark",className:"w-100 my-1",type:"button",children:" Cancel"})]}):e.jsx(c,{variant:"primary",className:"w-100",type:"submit",children:" Add Product"})]})})]})})}),e.jsxs("table",{className:"table table-dark table-striped table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"name"}),e.jsx("th",{children:"price"}),e.jsx("th",{children:"desc"}),e.jsx("th",{children:"hero"}),e.jsx("th",{children:"qty"}),e.jsx("th",{children:"actions"})]})}),e.jsx("tbody",{children:j&&j.result.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:r.name}),e.jsx("td",{children:r.price}),e.jsx("td",{children:r.desc}),e.jsx("td",{children:r.hero.map(a=>e.jsx("img",{src:a,height:50,className:"mx-2 rounded-2"},a))}),e.jsx("td",{children:r.qty}),e.jsxs("td",{children:[e.jsx(c,{className:"btn btn-sm mx-1",onClick:a=>N(r),children:"Edit"}),e.jsx(c,{className:"btn btn-sm mx-1",onClick:a=>b(r._id),children:"Delete"})]})]},r._id))})]})]})})};export{ce as default};
